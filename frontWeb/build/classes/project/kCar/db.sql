CREATE SEQUENCE REGIST_SEQ
	START WITH 1
	MAXVALUE 999;
DROP TABLE MEM_CAR_REGISTER;
DROP TABLE CAR_ESTIMATION ;
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'khs950','33바3520','그랜쟈',150000,'서울시 은평구',(sysdate+7),sysdate,'FALSE');
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'kdh940','18바8515','소나타',180000,'전라도 광주',(sysdate+3),sysdate,'FALSE');
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'les999','62누6952','케이파이브',50000,'경상도 대구',(sysdate+30),sysdate,'FALSE');
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'lsj960','31오7420','크루저',19000,'경기도 부천',(sysdate+14),sysdate,'FALSE');
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'aaa123','07오0252','그랜저',50000,'경상도 대구',(sysdate+30),sysdate,'FALSE');
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'12abddd','09구5500','아방',19000,'경기도 부천',(sysdate+14),sysdate,'FALSE');
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'Restqq','40머5052','케파',50000,'경상도 대구',(sysdate+30),sysdate,'FALSE');
INSERT INTO MEM_CAR_REGISTER VALUES 
('MCR-'||REGIST_SEQ.nextval,'doubledra','02오2222','말리부',19000,'경기도 부천',(sysdate+14),sysdate,'FALSE');


INSERT INTO MEM_INFO VALUES ('khs950','!!hs1995','11-11-111111-11','김학수','hackssu@naver.com','01098746658','회원');
INSERT INTO MEM_INFO VALUES ('kdh940','@@dh1994','12-12-121212-12','김동현','donghyun@naver.com','01095481248','회원');
INSERT INTO MEM_INFO VALUES ('les999','##es1999','31-31-111111-11','이은서','eunseo@naver.com','01033559955','관리자');
INSERT INTO MEM_INFO VALUES ('lsj960','!!sj1996','11-11-555555-11','임소정','sojung@naver.com','01093122658','회원');
INSERT INTO MEM_INFO VALUES ('aaa123','!!sj1996','14-11-512355-11','임소정','sojung@naver.com','01093122658','회원');
INSERT INTO MEM_INFO VALUES ('12abddd','!!sj1996','12-11-435515-11','임소정','sojung@naver.com','01093122658','회원');
INSERT INTO MEM_INFO VALUES ('doubledra','!!sj1996','21-11-554433-11','임소정','sojung@naver.com','01093122658','회원');
INSERT INTO MEM_INFO VALUES ('Restqq','!!sj1996','16-11-587655-11','임소정','sojung@naver.com','01093122658','회원');

SELECT * FROM MEM_CAR_REGISTER mcr ;
SELECT * FROM MEM_INFO mi ;
SELECT * FROM CAR_IMG ci ;
SELECT * FROM OPTION_INFO oi ;
SELECT * FROM CAR_REGIST_INFO cri ;
SELECT * FROM OKAY_CAR_REGISTER ocr ;
SELECT * FROM CAR_OPTIONS co ;
SELECT * FROM CAR_ESTIMATION ce ;

DELETE OKAY_CAR_REGISTER WHERE sell_or_not = 'N';
DELETE CAR_ESTIMATION WHERE isreg IS NULL;

UPDATE MEM_CAR_REGISTER SET eval = 'FALSE' WHERE eval = 'TRUE';
DELETE CAR_ESTIMATION WHERE ispass='판매가능';


DROP TABLE CAR_OPTIONS ;
DROP TABLE CAR_ESTIMATION ;
CREATE TABLE CAR_OPTIONS(
	CAR_NUM VARCHAR2(10),
	OPID VARCHAR2(10),
	FOREIGN KEY (CAR_NUM) REFERENCES OKAY_CAR_REGISTER (CAR_NUM)
	ON DELETE CASCADE,
	FOREIGN KEY (OPID) REFERENCES OPTION_INFO (OPID)
	ON DELETE CASCADE
);
CREATE TABLE CAR_ESTIMATION(
	CAR_NUM VARCHAR2(10) UNIQUE,
	ISPASS VARCHAR2(15),
	ACCIDENT_CNT NUMBER,
	DIAG VARCHAR2(12),
	isreg varchar2(5),
	FOREIGN KEY (CAR_NUM) REFERENCES MEM_CAR_REGISTER (CAR_NUM)
	ON DELETE CASCADE
);
CREATE TABLE MEM_CAR_REGISTER(
	REGIST_ID VARCHAR2(7) PRIMARY KEY,
	MEM_ID VARCHAR2(30),
	CAR_NUM VARCHAR2(10) UNIQUE,
	MODEL VARCHAR2(50) NOT NULL,
	DRIVE_DIST NUMBER(6),
	ADDRESS VARCHAR2(30) NOT NULL,
	WANT_TIME DATE,
	REG_TIME DATE,
	EVAL VARCHAR2(5),
	FOREIGN KEY (MEM_ID) REFERENCES MEM_INFO (MEM_ID)
	ON DELETE CASCADE
);

SELECT DISTINCT oi.OPNAME, co.CAR_NUM  FROM CAR_OPTIONS co,OPTION_INFO oi, CAR_OPTIONS co2
WHERE co.CAR_NUM = co2.CAR_NUM AND oi.OPID = co2.OPID ORDER BY CAR_NUM ;
SELECT * FROM CAR_OPTIONS co ;

SELECT mi.*,mcr.*,ce.ISPASS ,ce.ACCIDENT_CNT ,ce.DIAG ,ce.isreg
FROM MEM_CAR_REGISTER mcr ,CAR_ESTIMATION ce, MEM_INFO mi
WHERE mcr.CAR_NUM =ce.CAR_NUM AND mcr.MEM_ID = mi.MEM_ID
AND mcr.CAR_NUM like '%%' AND mcr.EVAL ='TRUE' ORDER BY isreg,WANT_TIME ASC;

SELECT mi.*, mcr.*,ce.ISPASS ,ce.ACCIDENT_CNT ,ce.DIAG ,ce.isreg FROM MEM_CAR_REGISTER mcr, CAR_ESTIMATION ce, MEM_INFO mi  
WHERE mcr.CAR_NUM =ce.CAR_NUM AND mcr.MEM_ID =mi.MEM_ID  ORDER BY isreg, WANT_TIME ASC;
SELECT * FROM MEM_INFO mi ;
SELECT * FROM CAR_ESTIMATION ce ;